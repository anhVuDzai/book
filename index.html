<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Menu</title>
    <link rel="stylesheet" href="./asset/css/mainstyle.css" />
    <link rel="stylesheet" href="./asset/css/reset.css" />
    <link rel="stylesheet" href="./asset/css/button.css" />
    <link rel="stylesheet" href="./asset/css/style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Poppins:wght@300;400;500&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div>
      <div
        style="
          width: 100%;
          height: 70px;
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 0 60px;
          background: white;
          box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
        "
      >
        <div style="display: flex; align-items: center">
          <div style="display: flex; align-items: center; gap: 10px">
            <div style="line-height: 1">
              <div
                style="
                  font-family: 'Playfair Display', serif;
                  font-size: 45px;
                  font-weight: 600;
                "
              >
                Book
              </div>
            </div>
          </div>

          <div
            style="display: flex; gap: 28px; font-size: 20px; margin-left: 80px"
          >
            <a href="#" style="text-decoration: none; color: #000">About Us</a>
            <a href="#" style="text-decoration: none; color: #000"
              >My Account</a
            >
          </div>
        </div>

        <!-- <div style="display: flex; gap: 20px; align-items: center">
          <div style="position: relative; font-size: 20px">
            üõí
            <span
              style="
                position: absolute;
                top: -6px;
                right: -8px;
                background: #00c853;
                color: white;
                border-radius: 50%;
                font-size: 10px;
                padding: 2px 5px;
              "
              >0</span
            >
          </div>

          <div style="position: relative; font-size: 20px">
            ‚ù§Ô∏è
            <span
              style="
                position: absolute;
                top: -6px;
                right: -8px;
                background: #00c853;
                color: white;
                border-radius: 50%;
                font-size: 10px;
                padding: 2px 5px;
              "
              >0</span
            >
          </div>
        </div> -->

        <div class="logbtn">
          <button
            class="buttonsty logout"
            type="button"
            style="
              background-color: rgba(255, 61, 61, 0.774);
              width: 100px;
              margin-left: 20px;
            "
          >
            Log out
          </button>
        </div>
      </div>

      <div class="banner">
        <div class="overlay"></div>
      </div>

      <div style="background-color: #ffffff; margin: 10px; max-width: auto">
        <div class="bookdisplay">
          <div class="best">
            <div class="bkType">
              <div class="book" style="display: grid">
                <div id="favourite" class="font"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="footer">
        <div
          style="
            border: 0;
            border-top: 1px solid gray;
            max-width: 80%;
            align-items: center;
            margin-left: 10%;
            display: flex;
            justify-content: space-between;
          "
        >
          <div class="font" style="color: rgba(12, 12, 12, 0.719)">
            <div style="font-size: small">
              <p>&copy; 2025 Book. All rights reserved.</p>
            </div>
          </div>
          <div style="display: flex"></div>
        </div>
      </div>
    </div>

    <script type="module">
      fetch(
        "https://www.googleapis.com/books/v1/volumes?q=js&maxResults=40&key=AIzaSyDxb0u7cxqiPJvvzTRT0GNO4duEZorSSm8"
      )
        .then((res) => res.json())
        .then((data) => {
          if (!data.items) {
            console.log("Kh√¥ng c√≥ s√°ch tr·∫£ v·ªÅ");
            return;
          } else {
            const container = document.getElementById("favourite");

            data.items.forEach((book) => {
              const info = book.volumeInfo;
              console.log(info);

              const div = document.createElement("div");
              div.style.margin = "5px";

              div.innerHTML = `<div style="border-radius: 8px; box-shadow: rgba(0, 0, 0, 0.02) 0px 1px 3px 0px, rgba(27, 31, 35, 0.15) 0px 0px 0px 1px;"> <div style="margin: 20px">
          <img src="${info.imageLinks.thumbnail || ""}" width="120" />
          <h4 class="font overflow" style="font-size: 17px; font-weight: bolder">${
            info.title
          }</h4>
          <p class="font overflow">${
            info.authors?.join(", ") || "Unknown"
          }</p></div></div>
        `;

              container.appendChild(div);
            });
          }
        });
    </script>

    <script>
      fetch(
        "https://www.googleapis.com/books/v1/volumes?q=harry+potter&key=AIzaSyDxb0u7cxqiPJvvzTRT0GNO4duEZorSSm8"
      )
        .then((res) => res.json())
        .then((data) => {
          data.items.forEach((book) => {
            const info = book.volumeInfo;
            const price = book.saleInfo?.listPrice;

            console.log("T√™n:", info.title);
            console.log(
              "Gi√°:",
              price
                ? `${price.amount} ${price.currencyCode}`
                : "Mi·ªÖn ph√≠ / Kh√¥ng b√°n"
            );
          });
        });
    </script>

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
      import {
        getAuth,
        onAuthStateChanged,
        signOut,
      } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";
      import {
        getFirestore,
        collection,
        getDocs,
        query,
        orderBy,
        where,
      } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

      const firebaseConfig = {
        apiKey: "AIzaSyCqtouu7EB6vThIRKJ6VSA8MURsIXQfuWI",
        authDomain: "book-4469c.firebaseapp.com",
        projectId: "book-4469c",
        storageBucket: "book-4469c.firebasestorage.app",
        messagingSenderId: "597597915442",
        appId: "1:597597915442:web:ff624237ef7d52961d6f2b",
        measurementId: "G-8DNPL9NF8P",
      };

      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const db = getFirestore(app);

      let currentUser = "";

      onAuthStateChanged(auth, (user) => {
        if (user) {
          currentUser = user.email;
          document.querySelector(".user").innerText = currentUser;
        } else {
          document.querySelector(".user").innerHTML = "Ch∆∞a c√≥ t√†i kho·∫£n";
          setupButtons(user);
        }
      });

      document.querySelector(".logout").addEventListener("click", async () => {
        if (confirm("Sign Out?")) {
          signOut(auth)
            .then(() => {
              console.log("sign out");
            })
            .catch((error) => {
              console.error(error);
            });
        } else {
          return;
        }
      });

      document.querySelector(".addBook").addEventListener("click", async () => {
        window.location.href = "addbook.html";
      });

      document.querySelector(".myBook").addEventListener("click", async () => {
        window.location.href = "myBook.html";
      });

      function setupButtons(user) {
        const logBtn = document.querySelector(".logbtn");

        if (user) {
          logBtn.innerHTML = `
      <button class="buttonsty logout"
        style="background-color: rgba(255, 61, 61, 0.774); width: 100px;">
        Log out
      </button>
    `;

          document.querySelector(".logout").onclick = () => {
            if (confirm("Sign Out?")) signOut(auth);
          };
        } else {
          logBtn.innerHTML = `
      <button class="buttonsty login"
        style="background-color: rgba(0 , 100, 255, 0.719); width: 100px; margin-left: 20px">
        Log in
      </button>
    `;

          document.querySelector(".login").onclick = () => {
            window.location.href = "login.html";
          };
        }
      }
    </script>
  </body>
</html>
