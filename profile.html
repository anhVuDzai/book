<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Profile</title>
    <link rel="stylesheet" href="./asset/css/mainstyle.css" />
    <link rel="stylesheet" href="./asset/css/reset.css" />
    <link rel="stylesheet" href="./asset/css/button.css" />
  </head>
  <body>
    <div class="container">
      <div class="navBar">
        <div
          style="
            padding: 0 50px;
            display: flex;
            width: 100%;
            justify-content: space-between;
          "
        >
          <div class="logo">
            <p style="margin-left: 5px; font-size: xx-large">
              <a
                class="font"
                style="text-decoration: none; color: #5f6368"
                href="index.html"
                >Book.</a
              >
            </p>
          </div>

          <div class="nav-content" style="display: flex; align-items: center">
            <button
              class="buttonsty addBook"
              type="button"
              style="
                background-color: rgba(28, 156, 92, 0.774);
                width: 150px;
                margin-right: 20px;
              "
            >
              + Thêm Truyện
            </button>

            <button
              class="buttonsty myBook"
              type="button"
              style="
                background-color: rgba(139, 139, 139, 0.774);
                width: 150px;
                margin-right: 20px;
              "
            >
              Truyện của tôi
            </button>

            <div class="username" style="display: flex; align-items: center">
              <a href="profile.html">
                <div
                  style="
                    border: 0px solid;
                    border-radius: 50%;
                    background-color: gray;
                    width: 35px;
                    height: 35px;
                    margin-right: 5px;
                  "
                ></div>
              </a>
              <div>
                <a
                  href="profile.html"
                  class="font"
                  style="text-decoration: none; color: #5f6368"
                >
                  <p class="user">Đang tải...</p>
                </a>
              </div>
            </div>
            <div class="logbtn">
              <button
                class="buttonsty logout"
                type="button"
                style="
                  background-color: rgba(255, 61, 61, 0.774);
                  width: 100px;
                  margin-left: 20px;
                "
              >
                Log out
              </button>
            </div>
          </div>
        </div>
      </div>
      <div class="footer">
        <div
          style="
            border: 0;
            border-top: 1px solid gray;
            max-width: 80%;
            align-items: center;
            margin-left: 10%;
            display: flex;
            justify-content: space-between;
          "
        >
          <div class="font" style="color: rgba(12, 12, 12, 0.719)">
            <div style="font-size: small">
              <p>&copy; 2025 Book. All rights reserved.</p>
            </div>
          </div>
          <div style="display: flex"></div>
        </div>
      </div>
    </div>
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
      import {
        getAuth,
        onAuthStateChanged,
        signOut,
      } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";
      import {
        getFirestore,
        collection,
        getDocs,
        query,
        orderBy,
        where,
      } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

      const firebaseConfig = {
        apiKey: "AIzaSyCqtouu7EB6vThIRKJ6VSA8MURsIXQfuWI",
        authDomain: "book-4469c.firebaseapp.com",
        projectId: "book-4469c",
        storageBucket: "book-4469c.firebasestorage.app",
        messagingSenderId: "597597915442",
        appId: "1:597597915442:web:ff624237ef7d52961d6f2b",
        measurementId: "G-8DNPL9NF8P",
      };

      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const db = getFirestore(app);

      let currentUser = "";

      onAuthStateChanged(auth, (user) => {
        if (user) {
          currentUser = user.email;
          document.querySelector(".user").innerText = currentUser;
          loadBook();
        } else {
          document.querySelector(".user").innerHTML = "Chưa có tài khoản";
          loadBook();
        }
      });

      document.querySelector(".addBook").addEventListener("click", async () => {
        window.location.href = "addbook.html";
      });

      document.querySelector(".myBook").addEventListener("click", async () => {
        window.location.href = "myBook.html";
      });
    </script>
  </body>
</html>
